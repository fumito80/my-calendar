(()=>{"use strict";var e={803:(e,t,n)=>{n.d(t,{$:()=>o,$2:()=>i,cf:()=>r,tq:()=>s});const a=864e5;function o(e){return document.getElementsByClassName(e)[0]}function r(e){return 864e5*Math.trunc((Number(e)-54e6)/864e5)+54e6}function s(){const e=new Date(r((new Date).setDate(1)));return new Date(Number(e)-(e.getDay()+6)%7*a)}function i(e){o("year").textContent=`${String((new Date).getFullYear())}（令和${String((new Date).getFullYear()-2018)}年）`;const t=e.sort(((e,t)=>e.dateNum-t.dateNum)),n=o("grid");n.innerHTML="";const i=Number(s()),{dates:c}=[...Array(91)].reduce(((e,t,n)=>{const o=new Date(i+a*n),[r,s]=function(e,t){const n=[];for(let a=0;a<e.length;a+=1)if(e[a].dateNum===t)n.push(e[a]);else if(e[a].dateNum>t)break;return[n,e.slice(n.length)]}(e.myEvents,Number(o));return{myEvents:s,dates:[...e.dates,{date:o,events:r}]}}),{myEvents:t,dates:[]});n.append(...["月","火","水","木","金","土","日"].map((e=>Object.assign(document.createElement("div"),{title:e}))),...c.map(function(e){const t=new Date(e).getMonth();return({date:n,events:a})=>{const o=1===n.getDate()?n.toLocaleDateString().substring(5):n.getDate(),r=Object.assign(document.createElement("div"),{title:o});Number(n)===e&&r.classList.add("today");const s=Math.abs(n.getMonth()-t);return r.classList.add(`month-${s}`),r.append(...a.map((({summary:e,eventType:t})=>Object.assign(document.createElement("div"),{title:e,className:t})))),r}}(r(Date.now()))))}}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var r=t[a]={exports:{}};return e[a](r,r.exports,n),r.exports}n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var a=n(803);const o=["https://apis.google.com/js/api.js","https://accounts.google.com/gsi/client"],r=["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"],s=["https://www.googleapis.com/auth/calendar.readonly"],i={21:"event",12:"anniversary",15:"owner"};async function c(){const{result:e}=await gapi.client.calendar.calendarList.list();return e.items.map((({id:e,colorId:t})=>({id:e,eventType:i[t]})))}async function l([e,...t],n=[]){if(!e)return n;const o=await async function(e){return(await gapi.client.calendar.events.list({calendarId:e.id,timeMin:(0,a.tq)().toISOString(),showDeleted:!1,singleEvents:!0,maxResults:30,orderBy:"startTime"})).result.items.map((t=>({eventType:"祝日"===t.description&&"event"===e.eventType?"holiday":e.eventType,dateNum:(0,a.cf)(new Date(t.start.date)),summary:t.summary})))}(e);return l(t,[...n,...o])}function u(){const e=(0,a.$)("api-key")?.value,t=(0,a.$)("client-id")?.value;return e&&t?Promise.resolve({apiKey:e,clientId:t}):Promise.reject()}async function d(e){return gapi.client.init({apiKey:e.apiKey,discoveryDocs:r})}function m(e,t,n){return({error:a})=>{void 0!==a&&n(a),localStorage.setItem("apiKey",e.apiKey),localStorage.setItem("clientId",e.clientId),t(e)}}async function p(){return new Promise((e=>{gapi.load("client",e)}))}async function g(e){const t="undefined"!=typeof gapi?gapi.client?.getToken():void 0;if(t&&await async function(e){return!!(await fetch(`https://oauth2.googleapis.com/tokeninfo?access_token=${e}`).then((e=>e.json()))).azp}(t.access_token))return c().then(l).then(a.$2).catch(console.error);const n=e.map((e=>new Promise((t=>{const n=document.head.appendChild(document.createElement("script"));n.src=e,n.addEventListener("load",t)}))));return Promise.all(n).then(p).then(u).then((async e=>new Promise(((t,n)=>{google.accounts.oauth2.initTokenClient({scope:s.join(" "),client_id:e.clientId,callback:m(e,t,n)}).requestAccessToken({prompt:""})})))).then(d).then(c).then(l).then(a.$2).catch(console.error)}(0,a.$)("api-key").value=localStorage.getItem("apiKey")||"",(0,a.$)("client-id").value=localStorage.getItem("clientId")||"",g(o),(0,a.$)("form-config")?.addEventListener("submit",(e=>{g(o),e.preventDefault()})),(0,a.$)("config")?.addEventListener("click",(()=>{const e=(0,a.$)("form-config"),t="none"===getComputedStyle(e).display;e.style.display=t?"flex":"none"}))})();